---
agent: agent
name: audio_driver_spec
---

윈도우 오디오 드라이버 (WDM) 최종 기능 명세

1. 프로젝트 개요

- 목적: 실시간 AI 가공을 지원하는 가상/물리 오디오 라우팅 시스템.
- 아키텍처:
  - Driver (Rust, no_std): 소프트웨어 버스 드라이버 역할. 가상 장치 생명주기 관리 및 링 버퍼 데이터 전송.
  - Tauri (Rust std): 데이터 허브 및 노드 기반 라우팅 로직 수행.
  - Node UI: 사용자 장치 생성/삭제 및 오디오 그래프 관리.

2. 확정된 주요 기능

[기능 1] 소프트웨어 버스 기반 장치 관리

- 동적 생성: 노드 배치 시 장치 즉시 생성 및 윈도우 사운드 제어판 노출.
- 지속성: 기본적으로 재부팅 후에도 장치 유지. 필요 시 UI에서 제거 가능.
- 사용자 정의 이름: 각 가상 장치에 고유 명칭 부여 및 실시간 변경 지원.

[기능 2] 링 버퍼 데이터 파이프라인

- 메커니즘: Zero-copy 커널-사용자 공유 메모리.
- 데이터 흐름: [물리/가상 캡처] -> [Tauri/AI 가공] -> [가상/물리 출력].
- 유연성: 다양한 오디오 포맷(PCM, Float) 및 채널 구성 대응.

[기능 3] 앱 수준 노드 라우팅

- 모든 데이터 중계는 Tauri 백엔드에서 수행하여 노드 그래프의 유연성 극대화.
- 노드 상태(On/Off)에 따른 실시간 데이터 바이패스.

3. 통신 레이아웃 (Structure Design)

- RingBufferHeader: 버퍼 커서 및 상태 관리.
- AudioFormat: 샘플 레이트, 비트 깊이 등 메타데이터.
- DeviceControl: 장치 생성/삭제/명칭 변경 명령 전송.
